<!DOCTYPE html>
<html lang="en">
<head>
  <title>Many-to-many relationships in Excel data model</title>
  <meta name="description" content="Orange Sun | Posts | Vitaly Potyarkin | 2023-06-02">
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="referrer" content="origin">
  <meta name="generator" content="Pelican">
  <link href="https://potyarkin.com/posts/2023/excel-many-to-many/" rel="canonical">
<link href="https://potyarkin.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Orange Sun Full Atom Feed" />
<link href="https://potyarkin.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Orange Sun Full RSS Feed" />
  <link href="https://potyarkin.com/theme/css/style.css?cache=ce1ce9e802f6452fc24c45dcd14f219b9fdbc4b78394fcb3ed490c23f88a6851" type="text/css" rel="stylesheet">
  <link href="https://potyarkin.com/theme/css/fonts.css?cache=32c843bb3ce96eb9fb92f48c7a63dc133ab32e0d267a2e1453199c23403d5cd0" type="text/css" rel="stylesheet">
  <link href="https://potyarkin.com/theme/css/codecolor/bleak.css?cache=4793611eaa86c9638927c57ac8d9995c5f7ca18d9ffed3721467cf3ef61b5e8e" type="text/css" rel="stylesheet">
    <link href="https://potyarkin.com/static/custom.css?cache=e3963750b86fbc40a84ec4f04703361dd7c0b05acd171c3015a6d39c5477d664" type="text/css" rel="stylesheet">
  <style>
  :root {
    --accent-hue: 14.917127071823206;
    --accent-saturation: 87.43961352657004%;
    --accent-lightness: 59.411764705882355%;
    --accent-rgb: #f26a3d;
  }
  </style>
  <meta name="theme-color" content="#f26a3d">
</head>
<body class="pelican-article">
<nav id="menu">
  <a href="#" class="close button">Close</a>
  <a href="#menu" class="open button">Menu</a>
  <ul class="menu-list">
      <li><a href="/archive/">Archive</a></li>
      <li><a href="/tags/">Tags</a></li>
      <li><a href="mailto:sio.wtf@gmail.com">Email</a></li>
      <li><a href="https://github.com/sio">Github</a></li>
      <li><a href="/feeds/">feeds</a></li>
      <li><a href="/bookmarks/">bookmarks</a></li>
      <li><a href="https://potyarkin.com/blogroll/">Blogroll</a></li>
      <li><a href="https://potyarkin.com/webring/">Webring</a></li>
  </ul>
</nav>  <header class="page-header">
    <h1>Many-to-many relationships in Excel data model</h1>
    <span class="subtitle"><a href="https://potyarkin.com/">Orange Sun</a> |
<a href="https://potyarkin.com/posts/">Posts</a> |   <a href="https://potyarkin.com/">Vitaly Potyarkin</a>
| 2023-06-02
</span>
  </header>
<article class="full"><p>This is a quick hack to build many-to-many relationships in Excel data model
even though they are not supported out of the box.</p>
<ul>
<li>
<p>Create intermediate <a href="https://stackoverflow.com/a/70682229">calculated table</a> and use DAX to fill it
    with unique values from related columns on both sides of the relationship:</p>
<div class="highlight"><pre><span></span><code>EVALUATE
  FILTER(
    DISTINCT(
      UNION(
        VALUES(&#39;TableA&#39;[Field]),
        VALUES(&#39;TableB&#39;[Field])
      )
    ),
    NOT(ISBLANK([Field]))
  )
</code></pre></div>

</li>
<li>
<p>Create two one-to-many relationships placing this intermediate table in
    between</p>
</li>
</ul>
<p>For all intents and purposes you may now forget that this intermediate table
exists: it will get updated automatically whenever you update the data model,
and it will not consume much resources. Pivot tables and DAX formulas will
work as if the two original tables were directly connected via many-to-many
link.</p>
<p>A similar intermediate table may be created with Power Query, but that's a lot
less elegant (unless you're already using Power Query elsewhere in the
workbook) and takes significantly longer to recalculate.</p></article>
<nav class="article-tags">
  <a href="https://potyarkin.com/tags/excel/">excel</a>
</nav>
<nav class="neighbors">
  <a class="neighbor neighbor-prev" href="https://potyarkin.com/posts/2023/10-year-pull-request/">
    <h1>A pull request 10 years in the making</h1>
    <p> Once upon a time there was a bug in a free software project that annoyed me for long...</p>
  </a>
  <a class="neighbor neighbor-next" href="https://potyarkin.com/posts/2023/ssh-agent-benchmark/">
    <h1>Benchmarking ssh-agent performance</h1>
    <p>I have an application idea that would require calling ssh-agent rather frequently -...</p>
  </a>
</nav>
<footer class="page-footer">
  <section class="credits">
        <span class="credits-left">
          Published with <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a>
        </span>
        <span class="credits-center">
          <a href="https://potyarkin.com/">Orange Sun</a>
        </span>
        <span class="credits-right">
          Theme <a href="https://github.com/sio/pelican-smallweb" rel="nofollow">SmallWeb</a>
        </span>
  </section>
</footer></body>
</html>