<!DOCTYPE html>
<html lang="en">
<head>
  <title>Getting started with LibPQ</title>
  <meta name="description" content="Orange Sun | Posts | Vitaly Potyarkin | 2018-04-01">
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="referrer" content="origin">
  <meta name="generator" content="Pelican">
  <link href="https://potyarkin.ml/posts/2018/getting-started-with-libpq/" rel="canonical">
<link href="https://potyarkin.ml/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Orange Sun Full Atom Feed" />
<link href="https://potyarkin.ml/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Orange Sun Full RSS Feed" />
  <link href="https://potyarkin.ml/theme/css/style.css" type="text/css" rel="stylesheet">
  <link href="https://potyarkin.ml/theme/css/fonts.css" type="text/css" rel="stylesheet">
</head>
<body class="pelican-article">
<nav id="menu">
  <a href="#" class="close button">Close</a>
  <a href="#menu" class="open button">Menu</a>
  <ul class="menu-list">
      <li><a href="/archive/">Archive</a></li>
      <li><a href="/tags/">Tags</a></li>
      <li><a href="mailto:sio.wtf@gmail.com">Email</a></li>
      <li><a href="https://github.com/sio">Github</a></li>
      <li><a href="/feeds/">feed</a></li>
  </ul>
</nav>  <header class="page-header">
    <h1>Getting started with LibPQ</h1>
    <span class="subtitle"><a href="https://potyarkin.ml/">Orange Sun</a> |
<a href="https://potyarkin.ml/posts/">Posts</a> |   <a href="https://potyarkin.ml/">Vitaly Potyarkin</a>
| 2018-04-01
</span>
  </header>
<article class="full"><p>This is a step by step guide to getting started with <a href="https://potyarkin.ml/posts/2018/expanding-power-query-standard-library-introducing-libpq/">LibPQ</a>, an illustrated
version of <a href="https://libpq.ml/#installation-and-usage">"Installation and usage"</a> section of the official
documentation.</p>
<h2 id="installation"><a class="toclink" href="#installation">Installation</a></h2>
<h3 id="libpq-source-code"><a class="toclink" href="#libpq-source-code">LibPQ source code</a></h3>
<p>The source code of the library has to be present in each workbook that uses it.</p>
<ul>
<li>Create a new blank query: <code>Data &gt; Get &amp; Transform &gt; From Other Sources &gt;
  Blank Query</code></li>
<li>Go to "Advanced editor" and replace the query code with the contents of
  <a href="https://potyarkin.ml/posts/2018/expanding-power-query-standard-library-introducing-libpq/"><code>LibPQ.pq</code></a> (switch to "Raw" view to make selecting easier)</li>
<li>Save new query under the name <code>LibPQ</code></li>
</ul>
<p><a href="https://potyarkin.ml/posts/2018/getting-started-with-libpq/libpq-main-module.png"><img alt="Main module of LibPQ" src="https://potyarkin.ml/posts/2018/getting-started-with-libpq/libpq-main-module.png"></a></p>
<h3 id="specifying-modules-location"><a class="toclink" href="#specifying-modules-location">Specifying modules location</a></h3>
<p>After the previous step LibPQ doesn't know yet where it should get the modules'
source code from. You can specify an unlimited number of local and web locations
where the modules are saved:</p>
<ul>
<li>Create a new blank query and name it <code>LibPQPath</code></li>
<li>Copy the contents of <a href="https://github.com/sio/LibPQ/blob/master/LibPQPath-sample.pq">LibPQPath-sample.pq</a> and modify it in Advanced editor.</li>
</ul>
<p><a href="https://potyarkin.ml/posts/2018/getting-started-with-libpq/libpq-path-editor.png"><img alt="LibPQ-Path" src="https://potyarkin.ml/posts/2018/getting-started-with-libpq/libpq-path-editor.png"></a></p>
<p>LibPQ will search for your modules first in local directories (in order they
are listed), then in web locations. If the module is found, no further
locations are checked.</p>
<p>It helps with the name collisions:</p>
<ul>
<li>Let's say you have a module <code>FavoritePets.pq</code> stored in your module
  collection at <code>http://yoursite.com/PowerQueryModules/</code></li>
<li>At the same time you use some modules from a friend's module collection
  at <code>http://friendname.com/PowerQueryModules/</code></li>
<li>If your friend adds a module with the same name to their collection, all
  you need to do to ignore it is to make sure that your collection address
  is higher in the <code>LibPQPath</code> than your friend's.</li>
<li>That works both ways: you and your friend can continue sharing your
  module collections while using personal modules with colliding names
  without any problems.</li>
</ul>
<h3 id="reusable-template"><a class="toclink" href="#reusable-template">Reusable template</a></h3>
<p>It is not necessary to repeat the installation steps every time you want to use LibPQ. You can add LibPQ to an empty workbook and save is as a template for future use.</p>
<h2 id="usage"><a class="toclink" href="#usage">Usage</a></h2>
<h3 id="importing-existing-module"><a class="toclink" href="#importing-existing-module">Importing existing module</a></h3>
<p>Import any available module with <code>LibPQ("ModuleName")</code> when writing your
queries in Advanced editor. LibPQ will search for the file named
<code>ModuleName.pq</code> in all locations that you've listed in LibPQPath. If the module
is found, its source code will be evaluated and the result will be returned.</p>
<p>For example, let's import <code>Date.Parse</code> from standard LibPQ collection:</p>
<p><a href="https://potyarkin.ml/posts/2018/getting-started-with-libpq/libpq-date-parse.png"><img alt="Date.Parse" src="https://potyarkin.ml/posts/2018/getting-started-with-libpq/libpq-date-parse.png"></a></p>
<p>That works because <code>LibPQPath</code> contains reference to
<code>https://raw.githubusercontent.com/sio/LibPQ/master/Modules/</code>, where the source
code for <code>Date.Parse.pq</code> is located.</p>
<h3 id="creating-a-new-module"><a class="toclink" href="#creating-a-new-module">Creating a new module</a></h3>
<p>You can save any reusable Power Query function or query to be imported by LibPQ
later:</p>
<ul>
<li>Copy the code of that module to any text editor (I recommend Notepad++) and
  save it with <code>*.pq</code> extension</li>
<li>Place the module into any location listed in <code>LibPQPath</code> and it will become
  available for importing</li>
</ul>
<p>If you have any further questions about LibPQ please create an <a href="https://github.com/sio/LibPQ/issues">issue</a> on GitHub
or contact me via <a href="mailto:sio.wtf@gmail.com">e-mail</a>.</p></article>
<nav class="article-tags">
  <a href="https://potyarkin.ml/tags/m/">m</a>
  <a href="https://potyarkin.ml/tags/power-query/">power-query</a>
  <a href="https://potyarkin.ml/tags/libpq/">LibPQ</a>
</nav>
<nav class="neighbors">
  <a class="neighbor neighbor-prev" href="https://potyarkin.ml/posts/2018/roads-and-bridges-sustaining-modern-digital-infrastructure/">
    <h1>Roads and Bridges - sustaining modern digital infrastructure</h1>
    <p>This week I have stumbled upon a very thorough review of existing problems and hidden...</p>
  </a>
  <a class="neighbor neighbor-next" href="https://potyarkin.ml/posts/2018/unit-testing-in-power-query-m-language/">
    <h1>Unit testing in Power Query M Language</h1>
    <p>As your code base gets bigger, test automation becomes more and more important. This...</p>
  </a>
</nav>
<footer class="page-footer">
  <section class="credits">
        <span class="credits-left">
          Published with <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a>
        </span>
        <span class="credits-center">
          <a href="https://potyarkin.ml/">Orange Sun</a>
        </span>
        <span class="credits-right">
          Theme <a href="https://github.com/sio/pelican-smallweb" rel="nofollow">SmallWeb</a>
        </span>
  </section>
</footer></body>
</html>